"use strict";(self.webpackChunkcom_app_shei_manageam=self.webpackChunkcom_app_shei_manageam||[]).push([[8867],{8632:(E,f,i)=>{i.d(f,{U:()=>H});var a=i(4762),h=i(5765),e=i(639),s=i(1772),m=i(6215),g=i(9019),u=i(9709),b=i(1841);let v=(()=>{class d{constructor(n,t){this.userService=n,this.http=t,this.url=g.N.apiUrl+"/health";const o=this.userService.fetchDetails(),{blood_pressure:r}=o;this.allBloodPressure=new m.X(r)}get(){return this.update(),this.allBloodPressure}update(){const n=this.userService.fetchDetails(),{user_details:{id:t}}=n;this.http.get(`${this.url}/allBloodPressure/${t}`).subscribe(o=>{this.userService.setDetails(Object.assign(Object.assign({},n),{blood_pressure:o})),this.allBloodPressure.next(o)})}remove(n){const t=this.userService.fetchDetails(),{user_details:{id:o}}=t;return this.http.delete(`${this.url}/deleteBloodPressure/${n}?user_id=${o}`)}add(n){const{user_details:{id:t}}=this.userService.fetchDetails();return this.http.post(`${this.url}/addBloodPressure`,Object.assign(Object.assign({},n),{user_id:t}))}}return d.\u0275fac=function(n){return new(n||d)(e.\u0275\u0275inject(u.K),e.\u0275\u0275inject(b.eN))},d.\u0275prov=e.\u0275\u0275defineInjectable({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();var _=i(4031),S=i(8431),x=i(7020),B=i(665),C=i(8583);function I(d,l){if(1&d&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275elementStart(1,"div",11),e.\u0275\u0275element(2,"ion-icon",12),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4,"Health Tip"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"p",13),e.\u0275\u0275elementEnd()),2&d){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("innerHTML",n.tip,e.\u0275\u0275sanitizeHtml)}}let w=(()=>{class d{constructor(n,t,o,r,c,p){this.modalController=n,this.bloodPressureService=t,this.platform=o,this.global=r,this.webSocket=c,this.auth=p,this.pressure={upper:"",lower:""},this.tip="",this.subs=[]}ngOnInit(){let n=this.platform.backButton.subscribe(()=>{this.modalController.dismiss()});this.subs.push(n)}updateTip(){this.tip=this.pressure.upper&&this.pressure.lower?(0,h.j3)(this.pressure.upper,this.pressure.lower).tips:""}scrollIntoView(n){n.scrollIntoView()}save(){if(!this.pressure.lower||!this.pressure.upper)return this.global.alert("Update blood pressure","All fields are required!",["OK"]);this.bloodPressureService.add(Object.assign({time:new Date},this.pressure)).subscribe(n=>{this.modalController.dismiss(),this.webSocket.emit("blood-pressure:update",{user_id:this.auth.loggedUser().id}),this.global.alert("Update blood pressure","Blood pressure sucessfully updated!",["OK"])})}ngOnDestroy(){this.subs.forEach(n=>n.unsubscribe())}}return d.\u0275fac=function(n){return new(n||d)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(s.Platform),e.\u0275\u0275directiveInject(_.U),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},d.\u0275cmp=e.\u0275\u0275defineComponent({type:d,selectors:[["app-update-blood-pressure"]],decls:18,vars:5,consts:[[1,"text-gray-900"],[1,"bg-blue-100","px-4","py-6","ion-no-border","text-xl","flex","justify-between","items-center"],[1,"font-bold"],["name","close",1,"bg-gray-500","text-2xl","text-white","rounded-full",3,"click"],[1,"p-4","space-y-4"],["position","stacked",1,"block","font-calibre","w-full"],["placeholder","Enter systolic reading","type","number",3,"value","ngModel","ngModelChange"],["onclick","scrollIntoView(this)"],["type","number","placeholder","Enter diastolic reading",3,"value","ngModel","ngModelChange"],[4,"ngIf"],[1,"w-full","bg-accentBlue","p-4","font-semibold","text-center","block","text-white","uppercase","rounded-xl","mt-10","bottom-4","sticky",3,"click"],[1,"flex","items-center"],["name","information-circle-outline",1,"text-blue-600","text-xl","inline-block","mr-2","relative","-top-1"],[1,"text-gray-400","mt-3","font-geomanist",3,"innerHTML"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"ion-app",0),e.\u0275\u0275elementStart(1,"ion-header",1),e.\u0275\u0275elementStart(2,"p",2),e.\u0275\u0275text(3,"Record Blood pressure"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-icon",3),e.\u0275\u0275listener("click",function(){return t.modalController.dismiss()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"ion-content"),e.\u0275\u0275elementStart(6,"div",4),e.\u0275\u0275elementStart(7,"ion-item"),e.\u0275\u0275elementStart(8,"ion-label",5),e.\u0275\u0275text(9,"Systolic - upper number(mmHg)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"ion-input",6),e.\u0275\u0275listener("ngModelChange",function(r){return t.pressure.upper=r})("ngModelChange",function(){return t.updateTip()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"ion-item",7),e.\u0275\u0275elementStart(12,"ion-label",5),e.\u0275\u0275text(13,"Diastolic - lower number (mmHg)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"ion-input",8),e.\u0275\u0275listener("ngModelChange",function(r){return t.pressure.lower=r})("ngModelChange",function(){return t.updateTip()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,I,6,1,"div",9),e.\u0275\u0275elementStart(16,"span",10),e.\u0275\u0275listener("click",function(){return t.save()}),e.\u0275\u0275text(17,"Done"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(10),e.\u0275\u0275property("value",t.pressure.upper)("ngModel",t.pressure.upper),e.\u0275\u0275advance(4),e.\u0275\u0275property("value",t.pressure.lower)("ngModel",t.pressure.lower),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.tip))},directives:[s.IonApp,s.IonHeader,s.IonIcon,s.IonContent,s.IonItem,s.IonLabel,s.IonInput,s.NumericValueAccessor,B.NgControlStatus,B.NgModel,C.NgIf],styles:[""]}),d})();var P=i(4442),j=i(2533),M=i(3047),T=i(3286),k=i(8932);function O(d,l){1&d&&(e.\u0275\u0275elementStart(0,"p",10),e.\u0275\u0275text(1," You have not added any Blood pressure reading yet "),e.\u0275\u0275elementEnd())}function U(d,l){if(1&d){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",11),e.\u0275\u0275elementStart(1,"p",12),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",13),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit;return e.\u0275\u0275nextContext().toggle(r)}),e.\u0275\u0275elementStart(4,"p",14),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"ion-icon",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"app-expandable",16),e.\u0275\u0275elementStart(8,"div",17),e.\u0275\u0275elementStart(9,"div",18),e.\u0275\u0275element(10,"ion-icon",19),e.\u0275\u0275elementStart(11,"span"),e.\u0275\u0275text(12,"Health Tip"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"p",20),e.\u0275\u0275elementStart(14,"p",21),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit;return e.\u0275\u0275nextContext().remove(r.id)}),e.\u0275\u0275text(15," Remove "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&d){const n=l.$implicit,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.date),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2("",n.upper,"/",n.lower," mmHg"),e.\u0275\u0275advance(1),e.\u0275\u0275classMapInterpolate1("text-xl ",n==t.expand?"rotate-90":"",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",n==t.expand),e.\u0275\u0275advance(6),e.\u0275\u0275property("innerHTML",n.tip,e.\u0275\u0275sanitizeHtml)}}let D=(()=>{class d{constructor(n,t,o,r,c,p,y){this.modalController=n,this.bloodPressureService=t,this.global=o,this.platform=r,this.healthService=c,this.webSocket=p,this.auth=y,this.expand=null,this.allBloodPressure=[],this.subs=[]}ngOnInit(){let n=this.platform.backButton.subscribe(()=>{this.modalController.dismiss()});this.subs.push(n),n=this.bloodPressureService.allBloodPressure.subscribe(t=>{this.data=t}),this.subs.push(n)}share(){return(0,a.mG)(this,void 0,void 0,function*(){this.modalController.dismiss();const n=yield this.modalController.create({component:j._,cssClass:"modal-80"});n.onDidDismiss().then(({data:t})=>(0,a.mG)(this,void 0,void 0,function*(){if(!t)return;const o=yield this.modalController.create({component:M.M,cssClass:"modal-50"}),r=t;o.onDidDismiss().then(({data:c})=>{!c||this.healthService.share(Object.assign(Object.assign({email:c},r),{type:"blood_pressure"})).subscribe(p=>this.global.alert("Shared Record",p,[{role:!0,text:"OK"}]))}),yield o.present()})),yield n.present()})}set data(n){this.allBloodPressure=n.sort((t,o)=>new Date(o.created_at).getTime()-new Date(t.created_at).getTime()).map(t=>(t.date=(0,P.ZP)(new Date(t.created_at),"dd mmm, yyyy-hh:MMtt"),t.tip=(0,h.j3)(t.upper,t.lower).tips,t))}toggle(n){this.expand=n==this.expand?null:n}remove(n){return(0,a.mG)(this,void 0,void 0,function*(){const{role:t}=yield this.global.alert("Remove Blood Pressure","Are you sure you want to remove blood pressure reading?",[{role:!1,text:"Cancel"},{role:!0,text:"OK"}]);!t||this.bloodPressureService.remove(n).subscribe(o=>{this.allBloodPressure=this.allBloodPressure.filter(r=>r.id!=n),this.webSocket.emit("blood-pressure:update",{user_id:this.auth.loggedUser().id})})})}ngOnDestroy(){this.subs.forEach(n=>n.unsubscribe())}}return d.\u0275fac=function(n){return new(n||d)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(_.U),e.\u0275\u0275directiveInject(s.Platform),e.\u0275\u0275directiveInject(T.z),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},d.\u0275cmp=e.\u0275\u0275defineComponent({type:d,selectors:[["app-view-blood-pressure"]],inputs:{data:"data"},decls:15,vars:2,consts:[[1,"pale-bg-default","text-gray-900"],[1,"ion-no-border","p-4","flex","justify-between","font-geomanist"],[1,"flex"],["name","arrow-back",1,"text-2xl",3,"click"],[1,"ml-4","block","text-gray-900","text-xl"],[1,"text-accentBlue","text-xl",3,"click"],[1,"pale-bg-default","p-4","font-bold","min-h-full"],[1,"mb-4"],["class","text-gray-500",4,"ngIf"],["class","bg-white p-4 mb-2",4,"ngFor","ngForOf"],[1,"text-gray-500"],[1,"bg-white","p-4","mb-2"],[1,"text-accentBlue"],[1,"flex","justify-between","items-center",3,"click"],[1,"text-lg"],["name","chevron-forward"],["expandHeight","5000px",3,"expanded"],[1,"bg-white","mt-6","text-gray-600","space-y-4"],[1,"flex","items-center"],["name","information-circle-outline",1,"text-blue-600","text-xl","inline-block","mr-2","relative"],[1,"text-gray-400","mt-3","font-geomanist",3,"innerHTML"],[1,"bg-red-600","font-bold","text-white","p-3","text-center","rounded-full",3,"click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"ion-app",0),e.\u0275\u0275elementStart(1,"ion-header",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275elementStart(3,"ion-icon",3),e.\u0275\u0275listener("click",function(){return t.modalController.dismiss()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"p",4),e.\u0275\u0275text(5,"Blood Pressure"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",5),e.\u0275\u0275listener("click",function(){return t.share()}),e.\u0275\u0275text(7,"Share"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"ion-content"),e.\u0275\u0275elementStart(9,"div",6),e.\u0275\u0275elementStart(10,"p",7),e.\u0275\u0275text(11,"Blood pressure history"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,O,2,0,"p",8),e.\u0275\u0275elementStart(13,"ul"),e.\u0275\u0275template(14,U,16,8,"li",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",0==t.allBloodPressure.length),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.allBloodPressure))},directives:[s.IonApp,s.IonHeader,s.IonIcon,s.IonContent,C.NgIf,C.NgForOf,k.I],styles:[""]}),d})();var V=i(688);let H=(()=>{class d{constructor(n,t,o,r){this.modalController=n,this.bloodPressureService=t,this.webSocket=o,this.auth=r,this.bloodPressure=null,this.allBloodPressure=[],this.subs=[],this.color=""}ngOnInit(){let n=this.bloodPressureService.get().subscribe(t=>{this.allBloodPressure=t,this.bloodPressure=t.slice(-1)[0],this.color=this.bloodPressure?(0,h.j3)(this.bloodPressure.upper,this.bloodPressure.lower).color:"gray"});this.subs.push(n),n=this.webSocket.listen("blood-pressure:update").subscribe(({user_id:t})=>{t==this.auth.loggedUser().id&&this.bloodPressureService.update()}),this.subs.push(n)}updateSugarColor(n,t){switch(!0){case 0===n&&0===t:return"#fff";case n<=120&&n>=90&&t<=80&&t>=60:return"green";case n<90:return"rgb(94, 93, 92)";case n>120&&n<=129:return"rgb(255, 236, 0)";case n>=130&&n<139:return"rgb(240, 128, 79)";case n>=140:default:return"red"}}view(){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.modalController.create({component:D,componentProps:{data:this.allBloodPressure}})).present()})}record(n=null){return(0,a.mG)(this,void 0,void 0,function*(){null==n||n.stopPropagation(),yield(yield this.modalController.create({component:w})).present()})}ngOndestroy(){this.subs.forEach(n=>n.unsubscribe())}}return d.\u0275fac=function(n){return new(n||d)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},d.\u0275cmp=e.\u0275\u0275defineComponent({type:d,selectors:[["app-blood-pressure"]],decls:11,vars:3,consts:[[1,"bg-blue-200","rounded-xl","p-4","text-center","relative","h-full","flex","flex-col","justify-between",3,"click"],["value","100",3,"color"],[1,"font-bold","text-2xl","mt-6"],[1,"text-sm","mb-1","inline-block"],[1,"font-bold"],[1,"border","border-accent","py-2","mt-1","rounded-xl",3,"click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("click",function(){return t.view()}),e.\u0275\u0275elementStart(1,"div"),e.\u0275\u0275element(2,"app-guage",1),e.\u0275\u0275elementStart(3,"p",2),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",3),e.\u0275\u0275text(6,"mmhg"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"p",4),e.\u0275\u0275text(8,"Blood Pressure"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"p",5),e.\u0275\u0275listener("click",function(r){return t.record(r)}),e.\u0275\u0275text(10," Record "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("color",t.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",(null==t.bloodPressure?null:t.bloodPressure.upper)||0,"/",(null==t.bloodPressure?null:t.bloodPressure.lower)||0," "))},directives:[V.l],styles:[""]}),d})()},3171:(E,f,i)=>{i.d(f,{$:()=>d});var a=i(4762),h=i(5765),e=i(639),s=i(1772),m=i(6215),g=i(9019),u=i(9709),b=i(1841);let v=(()=>{class l{constructor(t,o){this.userService=t,this.http=o,this.url=g.N.apiUrl+"/health";const r=this.userService.fetchDetails(),{blood_sugar:c}=r;this.allBloodSugar=new m.X(c)}get(){return this.update(),this.allBloodSugar}update(){const t=this.userService.fetchDetails(),{user_details:{id:o}}=t;this.http.get(`${this.url}/allBloodSugar/${o}`).subscribe(r=>{this.userService.setDetails(Object.assign(Object.assign({},t),{blood_sugar:r})),this.allBloodSugar.next(r)})}remove(t){const o=this.userService.fetchDetails(),{user_details:{id:r}}=o;return this.http.delete(`${this.url}/deleteBloodSugar/${t}?user_id=${r}`)}add(t){const{user_details:{id:o}}=this.userService.fetchDetails();return this.http.post(`${this.url}/addBloodSugar`,Object.assign(Object.assign({},t),{user_id:o}))}}return l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275inject(u.K),e.\u0275\u0275inject(b.eN))},l.\u0275prov=e.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var _=i(4031),S=i(8431),x=i(7020),B=i(665),C=i(8583);function I(l,n){if(1&l&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("(",t.bloodSugar.unit,")")}}function w(l,n){if(1&l&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275elementStart(1,"div",16),e.\u0275\u0275element(2,"ion-icon",17),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4,"Health Tip"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"p",18),e.\u0275\u0275elementEnd()),2&l){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("innerHTML",t.tip,e.\u0275\u0275sanitizeHtml)}}let P=(()=>{class l{constructor(t,o,r,c,p,y){this.modalController=t,this.bloodSugarService=o,this.platform=r,this.global=c,this.webSocket=p,this.auth=y,this.bloodSugar={unit:"",reading_time:"",reading:""},this.tip="",this.subs=[]}ngOnInit(){let t=this.platform.backButton.subscribe(()=>{this.modalController.dismiss()});this.subs.push(t)}updateTip(){this.tip=""!=this.bloodSugar.unit&&""!=this.bloodSugar.reading_time&&""!=this.bloodSugar.reading?(0,h.bD)(Object.assign(Object.assign({},this.bloodSugar),{value:this.bloodSugar.reading})).tips:""}save(){if(!this.bloodSugar.reading||!this.bloodSugar.reading_time||!this.bloodSugar.unit)return this.global.alert("Update blood sugar","All fields are required!",["OK"]);this.bloodSugarService.add(Object.assign(Object.assign({},this.bloodSugar),{time:new Date})).subscribe(t=>{this.modalController.dismiss(),this.webSocket.emit("blood-sugar:update",{user_id:this.auth.loggedUser().id}),this.global.alert("Update blood sugar","Blood sugar sucessfully updated!",["OK"])})}scrollIntoView(t){t.scrollIntoView()}ngOnDestroy(){this.subs.forEach(t=>t.unsubscribe())}}return l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(s.Platform),e.\u0275\u0275directiveInject(_.U),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["app-update-blood-sugar"]],decls:31,vars:7,consts:[[1,"text-gray-900"],[1,"bg-blue-100","px-4","py-6","ion-no-border","text-xl","flex","justify-between","items-center"],[1,"font-bold"],["name","close",1,"bg-gray-500","text-2xl","text-white","rounded-full",3,"click"],[1,"p-4","space-y-4"],["position","stacked",1,"block","font-calibre","w-full"],["value","mmol/l","placeholder","Choose unit of measurement","interface","popover",1,"w-full",3,"ngModel","ngModelChange"],["value","mmol/l"],["value","mg/dl"],["placeholder","Choose reading time","interface","popover",1,"w-full",3,"value","ngModel","ngModelChange"],["value","before"],["value","after"],["onclick","scrollIntoView(this)"],[4,"ngIf"],["placeholder","Enter blood sugar level","type","number",3,"value","ngModel","ngModelChange"],[1,"w-full","bg-accentBlue","p-4","font-semibold","text-center","block","text-white","uppercase","rounded-xl","mt-10","bottom-4","sticky",3,"click"],[1,"flex","items-center"],["name","information-circle-outline",1,"text-blue-600","text-xl","inline-block","mr-2","relative","-top-1"],[1,"text-gray-400","mt-3","font-geomanist",3,"innerHTML"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"ion-app",0),e.\u0275\u0275elementStart(1,"ion-header",1),e.\u0275\u0275elementStart(2,"p",2),e.\u0275\u0275text(3,"Record blood sugar level"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-icon",3),e.\u0275\u0275listener("click",function(){return o.modalController.dismiss()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"ion-content"),e.\u0275\u0275elementStart(6,"div",4),e.\u0275\u0275elementStart(7,"ion-item"),e.\u0275\u0275elementStart(8,"ion-label",5),e.\u0275\u0275text(9,"Unit of measurement"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"ion-select",6),e.\u0275\u0275listener("ngModelChange",function(c){return o.bloodSugar.unit=c})("ngModelChange",function(){return o.updateTip()}),e.\u0275\u0275elementStart(11,"ion-select-option",7),e.\u0275\u0275text(12,"mmol/L"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"ion-select-option",8),e.\u0275\u0275text(14,"mg/dl"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"ion-item"),e.\u0275\u0275elementStart(16,"ion-label",5),e.\u0275\u0275text(17,"Reading time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"ion-select",9),e.\u0275\u0275listener("ngModelChange",function(c){return o.bloodSugar.reading_time=c})("ngModelChange",function(){return o.updateTip()}),e.\u0275\u0275elementStart(19,"ion-select-option",10),e.\u0275\u0275text(20,"Before meal"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"ion-select-option",11),e.\u0275\u0275text(22," 2 hours after meal "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"ion-item",12),e.\u0275\u0275elementStart(24,"ion-label",5),e.\u0275\u0275text(25,"Blood glucose "),e.\u0275\u0275template(26,I,2,1,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"ion-input",14),e.\u0275\u0275listener("ngModelChange",function(c){return o.bloodSugar.reading=c})("ngModelChange",function(){return o.updateTip()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(28,w,6,1,"div",13),e.\u0275\u0275elementStart(29,"span",15),e.\u0275\u0275listener("click",function(){return o.save()}),e.\u0275\u0275text(30,"Done"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(10),e.\u0275\u0275property("ngModel",o.bloodSugar.unit),e.\u0275\u0275advance(8),e.\u0275\u0275property("value",o.bloodSugar.reading_time)("ngModel",o.bloodSugar.reading_time),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",o.bloodSugar.unit),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",o.bloodSugar.reading)("ngModel",o.bloodSugar.reading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.tip))},directives:[s.IonApp,s.IonHeader,s.IonIcon,s.IonContent,s.IonItem,s.IonLabel,s.IonSelect,s.SelectValueAccessor,B.NgControlStatus,B.NgModel,s.IonSelectOption,C.NgIf,s.IonInput,s.NumericValueAccessor],styles:[""]}),l})();var j=i(4442),M=i(2533),T=i(3047),k=i(3286),O=i(8932);function U(l,n){1&l&&(e.\u0275\u0275elementStart(0,"p",10),e.\u0275\u0275text(1," You have not added any Blood sugar reading yet "),e.\u0275\u0275elementEnd())}function D(l,n){if(1&l){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",11),e.\u0275\u0275elementStart(1,"p",12),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",13),e.\u0275\u0275listener("click",function(){const c=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275nextContext().toggle(c)}),e.\u0275\u0275elementStart(4,"p",14),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"ion-icon",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"app-expandable",16),e.\u0275\u0275elementStart(8,"div",17),e.\u0275\u0275elementStart(9,"div",18),e.\u0275\u0275element(10,"ion-icon",19),e.\u0275\u0275elementStart(11,"span"),e.\u0275\u0275text(12,"Health Tip"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"p",20),e.\u0275\u0275elementStart(14,"p",21),e.\u0275\u0275listener("click",function(){const c=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275nextContext().remove(c.id)}),e.\u0275\u0275text(15," Remove "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&l){const t=n.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",t.reading_time," meal - ",t.date," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2("",t.reading,"",t.unit,""),e.\u0275\u0275advance(1),e.\u0275\u0275classMapInterpolate1("text-xl ",t==o.expand?"rotate-90":"",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",t==o.expand),e.\u0275\u0275advance(6),e.\u0275\u0275property("innerHTML",t.tip,e.\u0275\u0275sanitizeHtml)}}let V=(()=>{class l{constructor(t,o,r,c,p,y,$){this.modalController=t,this.bloodSugarService=o,this.global=r,this.platform=c,this.healthService=p,this.webSocket=y,this.auth=$,this.expand=null,this.bloodSugar=[],this.subs=[]}ngOnInit(){let t=this.platform.backButton.subscribe(()=>{this.modalController.dismiss()});this.subs.push(t),this.bloodSugarService.allBloodSugar.subscribe(o=>{this.data=o}),this.subs.push(t)}set data(t){this.bloodSugar=t.sort((o,r)=>new Date(r.created_at).getTime()-new Date(o.created_at).getTime()).map(o=>(o.date=(0,j.ZP)(new Date(o.created_at),"dd mmm, yyyy-hh:MMtt"),o.tip=(0,h.bD)(Object.assign(Object.assign({},o),{value:o.reading})).tips,o))}share(){return(0,a.mG)(this,void 0,void 0,function*(){this.modalController.dismiss();const t=yield this.modalController.create({component:M._,cssClass:"modal-80"});t.onDidDismiss().then(({data:o})=>(0,a.mG)(this,void 0,void 0,function*(){if(!o)return;const r=yield this.modalController.create({component:T.M,cssClass:"modal-50"}),c=o;r.onDidDismiss().then(({data:p})=>{!p||this.healthService.share(Object.assign(Object.assign({email:p},c),{type:"blood_sugar"})).subscribe(y=>this.global.alert("Shared Record",y,[{role:!0,text:"OK"}]))}),yield r.present()})),yield t.present()})}toggle(t){this.expand=t==this.expand?null:t}remove(t){return(0,a.mG)(this,void 0,void 0,function*(){const{role:o}=yield this.global.alert("Remove Blood Sugar","Are you sure you want to remove blood sugar reading?",[{role:!1,text:"Cancel"},{role:!0,text:"OK"}]);o&&this.bloodSugarService.remove(t).subscribe(()=>{this.bloodSugar=this.bloodSugar.filter(r=>r.id!=t),this.webSocket.emit("blood-sugar:update",{user_id:this.auth.loggedUser().id})})})}ngOnDestroy(){this.subs.forEach(t=>t.unsubscribe())}}return l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(_.U),e.\u0275\u0275directiveInject(s.Platform),e.\u0275\u0275directiveInject(k.z),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["app-view-blood-sugar"]],inputs:{data:"data"},decls:15,vars:2,consts:[[1,"pale-bg-default","text-gray-900"],[1,"ion-no-border","p-4","flex","justify-between","font-geomanist"],[1,"flex"],["name","arrow-back",1,"text-2xl",3,"click"],[1,"ml-4","block","text-gray-900","text-xl"],[1,"text-accentBlue","text-xl",3,"click"],[1,"pale-bg-default","p-4","font-bold","min-h-full"],[1,"mb-4"],["class","text-gray-500",4,"ngIf"],["class","bg-white p-4 mb-1",4,"ngFor","ngForOf"],[1,"text-gray-500"],[1,"bg-white","p-4","mb-1"],[1,"text-accentBlue"],[1,"flex","justify-between","items-center",3,"click"],[1,"text-lg"],["name","chevron-forward"],["expandHeight","1000px",3,"expanded"],[1,"bg-white","mt-6","text-gray-600","space-y-4"],[1,"flex","items-center"],["name","information-circle-outline",1,"text-blue-600","text-xl","inline-block","mr-2","relative"],[1,"text-gray-400","mt-3","font-geomanist",3,"innerHTML"],[1,"bg-red-600","font-bold","text-white","p-3","text-center","rounded-full",3,"click"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"ion-app",0),e.\u0275\u0275elementStart(1,"ion-header",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275elementStart(3,"ion-icon",3),e.\u0275\u0275listener("click",function(){return o.modalController.dismiss()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"p",4),e.\u0275\u0275text(5,"Blood sugar"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",5),e.\u0275\u0275listener("click",function(){return o.share()}),e.\u0275\u0275text(7,"Share"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"ion-content"),e.\u0275\u0275elementStart(9,"div",6),e.\u0275\u0275elementStart(10,"p",7),e.\u0275\u0275text(11,"Blood sugar history"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,U,2,0,"p",8),e.\u0275\u0275elementStart(13,"ul"),e.\u0275\u0275template(14,D,16,9,"li",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",0==o.bloodSugar.length),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",o.bloodSugar))},directives:[s.IonApp,s.IonHeader,s.IonIcon,s.IonContent,C.NgIf,C.NgForOf,O.I],styles:[""]}),l})();var H=i(688);let d=(()=>{class l{constructor(t,o,r,c){this.modalController=t,this.bloodSugarService=o,this.webSocket=r,this.auth=c,this.bloodSugar=null,this.color="gray",this.allBloodSugar=[],this.subs=[]}ngOnInit(){this.fetch();let t=this.webSocket.listen("blood-sugar:update").subscribe(({user_id:o})=>{o==this.auth.loggedUser().id&&this.bloodSugarService.update()});this.subs.push(t)}fetch(){this.bloodSugarService.get().subscribe(t=>{this.allBloodSugar=t,this.bloodSugar=t.slice(-1)[0],this.bloodSugar&&(this.bloodSugar.reading=Number(this.bloodSugar.reading)),this.color=this.bloodSugar?(0,h.bD)(this.bloodSugar).color:"gray"})}view(){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.modalController.create({component:V,componentProps:{data:this.allBloodSugar}})).present()})}record(t=null){return(0,a.mG)(this,void 0,void 0,function*(){null==t||t.stopPropagation(),yield(yield this.modalController.create({component:P,componentProps:{data:this.allBloodSugar}})).present()})}ngOndestroy(){this.subs.forEach(t=>t.unsubscribe())}}return l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(s.ModalController),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(S.i),e.\u0275\u0275directiveInject(x.$))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["app-blood-sugar"]],decls:11,vars:3,consts:[[1,"bg-pink-200","rounded-xl","p-4","text-center","relative","h-full","flex","flex-col","justify-between",3,"click"],["value","100",3,"color"],[1,"font-bold","text-2xl","mt-6"],[1,"text-sm","mb-1","inline-block"],[1,"font-bold"],[1,"border","border-accent","py-2","mt-1","rounded-xl",3,"click"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("click",function(){return o.view()}),e.\u0275\u0275elementStart(1,"div"),e.\u0275\u0275element(2,"app-guage",1),e.\u0275\u0275elementStart(3,"p",2),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",3),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"p",4),e.\u0275\u0275text(8,"Blood sugar"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"p",5),e.\u0275\u0275listener("click",function(c){return o.record(c)}),e.\u0275\u0275text(10," Record "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("color",o.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate((null==o.bloodSugar?null:o.bloodSugar.reading)||0),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(null==o.bloodSugar?null:o.bloodSugar.unit))},directives:[H.l],styles:[""]}),l})()},8932:(E,f,i)=>{i.d(f,{I:()=>s});var a=i(639);const h=["expandWrapper"],e=["*"];let s=(()=>{class m{constructor(u){this.renderer=u,this.expanded=!1,this.expandHeight="200px"}ngAfterViewInit(){this.renderer.setStyle(this.expandWrapper.nativeElement,"max-height","1000px")}}return m.\u0275fac=function(u){return new(u||m)(a.\u0275\u0275directiveInject(a.Renderer2))},m.\u0275cmp=a.\u0275\u0275defineComponent({type:m,selectors:[["app-expandable"]],viewQuery:function(u,b){if(1&u&&a.\u0275\u0275viewQuery(h,5,a.ElementRef),2&u){let v;a.\u0275\u0275queryRefresh(v=a.\u0275\u0275loadQuery())&&(b.expandWrapper=v.first)}},inputs:{expanded:"expanded",expandHeight:"expandHeight"},ngContentSelectors:e,decls:3,vars:2,consts:[[1,"expand-wrapper","font-geomanist"],["expandWrapper",""]],template:function(u,b){1&u&&(a.\u0275\u0275projectionDef(),a.\u0275\u0275elementStart(0,"div",0,1),a.\u0275\u0275projection(2),a.\u0275\u0275elementEnd()),2&u&&a.\u0275\u0275classProp("collapsed",!b.expanded)},styles:[".expand-wrapper[_ngcontent-%COMP%]{transition:max-height .4s ease-in-out;overflow:hidden;height:auto}.collapsed[_ngcontent-%COMP%]{max-height:0!important}"]}),m})()},688:(E,f,i)=>{i.d(f,{l:()=>s});var a=i(639);const h=function(m){return{stroke:m}},e=function(m){return{"stroke-dashoffset":m}};let s=(()=>{class m{constructor(){this.range=-10,this.appearance="green"}ngOnInit(){}set value(u){this.range=-u/100*141}set color(u){this.appearance=u}}return m.\u0275fac=function(u){return new(u||m)},m.\u0275cmp=a.\u0275\u0275defineComponent({type:m,selectors:[["app-guage"]],inputs:{value:"value",color:"color"},decls:4,vars:8,consts:[[1,"w-full","absolute","flex","justify-center","p-4","pb-0","left-0","top-0",2,"max-height","60%"],["viewBox","0 0 100 80",1,"",2,"max-width","190px"],["d","M5 50 A20 20, 0,0 1,95 50 ","stroke","blue","stroke-width","5","fill","none"],["d","M5 50 A20 20, 0,0 1,95 50 ","stroke","white","stroke-width","5.7","fill","none",1,"arc"]],template:function(u,b){1&u&&(a.\u0275\u0275elementStart(0,"div",0),a.\u0275\u0275namespaceSVG(),a.\u0275\u0275elementStart(1,"svg",1),a.\u0275\u0275element(2,"path",2),a.\u0275\u0275element(3,"path",3),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementEnd()),2&u&&(a.\u0275\u0275advance(2),a.\u0275\u0275styleMap(a.\u0275\u0275pureFunction1(4,h,b.appearance)),a.\u0275\u0275advance(1),a.\u0275\u0275styleMap(a.\u0275\u0275pureFunction1(6,e,b.range)))},styles:[".arc[_ngcontent-%COMP%]{stroke-dasharray:141;stroke-dashoffset:0}"]}),m})()}}]);